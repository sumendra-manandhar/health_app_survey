(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[395],{28825:function(e,n,s){Promise.resolve().then(s.bind(s,86414))},86414:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return I}});var t=s(57437),a=s(2265),i=s(66070),r=s(62869),l=s(35974),c=s(65613),d=s(19378),o=s(32759),g=s(62926),m=s(75395),u=s(91723),f=s(49322),h=s(82431),x=s(17689),y=s(41671),j=s(42224);function p(){let[e,n]=(0,a.useState)({isOnline:"undefined"==typeof navigator||navigator.onLine,pendingCount:0,isSyncing:!1}),[s,d]=(0,a.useState)(0),[p,v]=(0,a.useState)("");(0,a.useEffect)(()=>{S();let e=()=>{n(e=>({...e,isOnline:!0})),S(),N()},s=()=>{n(e=>({...e,isOnline:!1})),S()};window.addEventListener("online",e),window.addEventListener("offline",s);let t=setInterval(S,3e4);return()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s),clearInterval(t)}},[]);let S=()=>{let e=j.s.getSyncStatus(),s=j.s.getPendingSyncCount();n(n=>({...n,...e,pendingCount:s,isOnline:"undefined"==typeof navigator||navigator.onLine}))},N=async()=>{if("undefined"!=typeof navigator&&!navigator.onLine){v("Cannot sync while offline");return}let e=j.s.getPendingSyncCount();if(0===e){v("No pending items to sync");return}n(e=>({...e,isSyncing:!0})),d(0),v("Starting sync...");try{let n=j.s.getUnsyncedRegistrations(),s=j.s.getUnsyncedScreenings();v("Syncing ".concat(n.length," registrations and ").concat(s.length," screenings")),d(25);let t=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrations:n.map(e=>e.data),screenings:s.map(e=>e.data)})});d(75);let a=await t.json();if(a.success)n.forEach(e=>j.s.markRegistrationSynced(e.id)),s.forEach(e=>j.s.markScreeningSynced(e.id)),j.s.setSyncStatus({lastSync:new Date().toISOString(),isOnline:!0,pendingCount:0}),d(100),v("Successfully synced ".concat(e," items")),S();else throw Error(a.message||"Sync failed")}catch(e){console.error("Sync error:",e),v("Sync failed: ".concat(e))}finally{n(e=>({...e,isSyncing:!1})),setTimeout(()=>{d(0),v("")},3e3)}};return(0,t.jsxs)(i.Zb,{className:"w-full",children:[(0,t.jsxs)(i.Ol,{className:"pb-3",children:[(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[e.isOnline?(0,t.jsx)(g.Z,{className:"h-5 w-5 text-green-500"}):(0,t.jsx)(m.Z,{className:"h-5 w-5 text-red-500"}),"Sync Status"]}),(0,t.jsx)(i.SZ,{children:e.isOnline?"Connected to server":"Working offline"})]}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Connection:"}),(0,t.jsx)(l.C,{variant:e.isOnline?"default":"destructive",children:e.isOnline?"Online":"Offline"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Pending Items:"}),(0,t.jsx)(l.C,{variant:e.pendingCount>0?"secondary":"outline",children:e.pendingCount})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm font-medium flex items-center gap-1",children:[(0,t.jsx)(u.Z,{className:"h-3 w-3"}),"Last Sync:"]}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:(e=>{if(!e)return"Never";let n=new Date(e),s=Math.floor((new Date().getTime()-n.getTime())/6e4);return s<1?"Just now":s<60?"".concat(s,"m ago"):s<1440?"".concat(Math.floor(s/60),"h ago"):n.toLocaleDateString()})(e.lastSync)})]}),e.isSyncing&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.E,{value:s,className:"w-full"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:p})]}),p&&!e.isSyncing&&(0,t.jsxs)(c.bZ,{children:[(0,t.jsx)(f.Z,{className:"h-4 w-4"}),(0,t.jsx)(c.X,{children:p})]}),(0,t.jsx)(r.z,{onClick:()=>{N()},disabled:!e.isOnline||e.isSyncing||0===e.pendingCount,className:"w-full",children:e.isSyncing?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Syncing..."]}):e.pendingCount>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Sync ",e.pendingCount," Items"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"All Synced"]})}),!e.isOnline&&(0,t.jsxs)(c.bZ,{children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(c.X,{children:"You're working offline. Data will be saved locally and synced when connection is restored."})]})]})]})}var v=s(92369),S=s(13041),N=s(31047),b=s(83774),w=s(42208),O=s(32660),C=s(18930),E=s(50091),_=s(95805),R=s(48736),A=s(27648);function I(){let[e,n]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),[u,f]=(0,a.useState)([]),[x,y]=(0,a.useState)(null),[I,Z]=(0,a.useState)(!0),[k,L]=(0,a.useState)(!1),[T,Y]=(0,a.useState)("all");(0,a.useEffect)(()=>{Z(navigator.onLine),P();let e=()=>{Z(!0),P()},n=()=>Z(!1);return window.addEventListener("online",e),window.addEventListener("offline",n),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[]);let P=()=>{let e=j.s.getUnsyncedRegistrations(),s=j.s.getUnsyncedScreenings(),t=j.s.getOfflineRegistrations();n(e),o(s),f(t)},z=async()=>{if(!I){alert("Cannot sync while offline. Please check your internet connection.");return}L(!0);try{let e=j.s.getUnsyncedRegistrations(),n=j.s.getUnsyncedScreenings();if(0===e.length&&0===n.length){alert("No pending items to sync.");return}let s=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrations:e.map(e=>e.data),screenings:n.map(e=>e.data)})}),t=await s.json();t.success?(e.forEach(e=>j.s.markRegistrationSynced(e.id)),n.forEach(e=>j.s.markScreeningSynced(e.id)),P(),alert("Successfully synced ".concat(e.length," registrations and ").concat(n.length," screenings."))):alert("Sync failed: ".concat(t.message))}catch(e){console.error("Manual sync error:",e),alert("Sync failed. Please try again.")}finally{L(!1)}},D=e=>new Date(e).toLocaleString("ne-NP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=e=>{y(e)},J=()=>{switch(T){case"pending":return u.filter(e=>!e.synced);case"synced":return u.filter(e=>e.synced);default:return u}},K=e=>{let{registration:n}=e;return(0,t.jsx)("div",{className:"border rounded-lg p-4 space-y-3 hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 text-blue-500"}),(0,t.jsx)("h3",{className:"font-semibold text-lg",children:n.data.child_name||"Unknown Child"}),(0,t.jsx)(l.C,{variant:n.synced?"default":"secondary",children:n.synced?"Synced":"Pending"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"font-medium",children:"Serial:"}),(0,t.jsx)("span",{children:n.data.serial_no})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(S.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:n.data.contact_number})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"font-medium",children:"Guardian:"}),(0,t.jsx)("span",{children:n.data.guardian_name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(N.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:n.data.date_of_birth})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 md:col-span-2",children:[(0,t.jsx)(b.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:n.data.address})]})]}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Created: ",D(n.timestamp),n.syncedAt&&(0,t.jsxs)("span",{className:"ml-2",children:["• Synced: ",D(n.syncedAt)]})]})]}),(0,t.jsx)(r.z,{variant:"outline",size:"sm",onClick:()=>U(n),children:(0,t.jsx)(w.Z,{className:"h-4 w-4"})})]})})};return(0,t.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(A.default,{href:"/",children:(0,t.jsxs)(r.z,{variant:"outline",size:"sm",children:[(0,t.jsx)(O.Z,{className:"mr-2 h-4 w-4"}),"Back to Home"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Data Synchronization"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage offline data and sync with server"})]}),(0,t.jsx)("div",{className:"ml-auto flex items-center gap-2",children:I?(0,t.jsxs)(l.C,{variant:"default",className:"bg-green-500",children:[(0,t.jsx)(g.Z,{className:"mr-1 h-3 w-3"}),"Online"]}):(0,t.jsxs)(l.C,{variant:"destructive",children:[(0,t.jsx)(m.Z,{className:"mr-1 h-3 w-3"}),"Offline"]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsx)(i.ll,{children:"Sync Controls"}),(0,t.jsx)(i.SZ,{children:"Manage data synchronization"})]}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[(0,t.jsx)(r.z,{onClick:z,disabled:!I||k,className:"w-full",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Syncing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Manual Sync"]})}),(0,t.jsxs)(r.z,{variant:"destructive",onClick:()=>{confirm("Are you sure you want to clear all offline data? This cannot be undone.")&&(j.s.clearAllData(),P())},className:"w-full",children:[(0,t.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Clear All Data"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,t.jsx)("p",{children:"• Manual sync uploads all pending data"}),(0,t.jsx)("p",{children:"• Auto-sync happens when you go online"}),(0,t.jsx)("p",{children:"• Clear data removes all local storage"})]})]})]}),(0,t.jsx)(p,{})]}),(0,t.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(i.ll,{className:"text-sm font-medium",children:"Total Patients"}),(0,t.jsx)(E.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(i.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:u.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Stored locally"})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(i.ll,{className:"text-sm font-medium",children:"Pending Sync"}),(0,t.jsx)(_.Z,{className:"h-4 w-4 text-orange-500"})]}),(0,t.jsxs)(i.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:e.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Need to sync"})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(i.ll,{className:"text-sm font-medium",children:"Synced"}),(0,t.jsx)(R.Z,{className:"h-4 w-4 text-green-500"})]}),(0,t.jsxs)(i.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:u.filter(e=>e.synced).length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successfully synced"})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(i.ll,{className:"text-sm font-medium",children:"Screenings"}),(0,t.jsx)(R.Z,{className:"h-4 w-4 text-blue-500"})]}),(0,t.jsxs)(i.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pending screenings"})]})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.ll,{children:["Patient Data (",J().length,")"]}),(0,t.jsx)(i.SZ,{children:"All patient registrations stored locally"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(r.z,{variant:"all"===T?"default":"outline",size:"sm",onClick:()=>Y("all"),children:["All (",u.length,")"]}),(0,t.jsxs)(r.z,{variant:"pending"===T?"default":"outline",size:"sm",onClick:()=>Y("pending"),children:["Pending (",e.length,")"]}),(0,t.jsxs)(r.z,{variant:"synced"===T?"default":"outline",size:"sm",onClick:()=>Y("synced"),children:["Synced (",u.filter(e=>e.synced).length,")"]})]})]})}),(0,t.jsx)(i.aY,{children:0===J().length?(0,t.jsx)(c.bZ,{children:(0,t.jsxs)(c.X,{children:["all"===T&&"No patient data found. Register some patients to see them here.","pending"===T&&"No pending patients. All data is synced with the server.","synced"===T&&"No synced patients yet."]})}):(0,t.jsx)(d.x,{className:"h-[500px]",children:(0,t.jsx)("div",{className:"space-y-4",children:J().map(e=>(0,t.jsx)(K,{registration:e},e.id))})})})]}),s.length>0&&(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)(i.ll,{children:["Pending Screenings (",s.length,")"]}),(0,t.jsx)(i.SZ,{children:"Screening data waiting to be synced"})]}),(0,t.jsx)(i.aY,{children:(0,t.jsx)(d.x,{className:"h-[300px]",children:(0,t.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border border-blue-200 rounded-lg bg-blue-50",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:[e.data.screening_type||"Unknown"," Screening"]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Patient: ",e.data.patient_name||"Unknown"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Created: ",D(e.timestamp)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.C,{variant:"outline",children:"Screening"}),(0,t.jsx)(r.z,{variant:"outline",size:"sm",onClick:()=>U(e),children:(0,t.jsx)(w.Z,{className:"h-4 w-4"})})]})]},e.id))})})})]})]})]}),x&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)(i.Zb,{className:"w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ll,{children:"Patient Details"}),(0,t.jsxs)(i.SZ,{children:[x.data.child_name||"Unknown Patient"," -",x.synced?" Synced":" Pending Sync"]})]}),(0,t.jsx)(r.z,{variant:"outline",size:"sm",onClick:()=>y(null),children:"Close"})]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)(d.x,{className:"h-[500px]",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Patient Information"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Name:"})," ",x.data.child_name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Serial:"})," ",x.data.serial_no]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"DOB:"})," ",x.data.date_of_birth]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Guardian:"})," ",x.data.guardian_name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Contact:"})," ",x.data.contact_number]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Address:"})," ",x.data.address]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"System Information"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Local ID:"})," ",x.id]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Created:"})," ",D(x.timestamp)]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Status:"})," ",x.synced?"Synced":"Pending"]}),x.syncedAt&&(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Synced At:"})," ",D(x.syncedAt)]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Raw Data (JSON)"}),(0,t.jsx)("pre",{className:"text-sm bg-muted p-4 rounded-lg overflow-auto",children:JSON.stringify(x,null,2)})]})]})})})]})})]})}},65613:function(e,n,s){"use strict";s.d(n,{X:function(){return d},bZ:function(){return c}});var t=s(57437),a=s(2265),i=s(90535),r=s(94508);let l=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,n)=>{let{className:s,variant:a,...i}=e;return(0,t.jsx)("div",{ref:n,role:"alert",className:(0,r.cn)(l({variant:a}),s),...i})});c.displayName="Alert",a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("h5",{ref:n,className:(0,r.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,r.cn)("text-sm [&_p]:leading-relaxed",s),...a})});d.displayName="AlertDescription"},35974:function(e,n,s){"use strict";s.d(n,{C:function(){return l}});var t=s(57437);s(2265);var a=s(90535),i=s(94508);let r=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:n,variant:s,...a}=e;return(0,t.jsx)("div",{className:(0,i.cn)(r({variant:s}),n),...a})}},62869:function(e,n,s){"use strict";s.d(n,{z:function(){return d}});var t=s(57437),a=s(2265),i=s(37053),r=s(90535),l=s(94508);let c=(0,r.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,n)=>{let{className:s,variant:a,size:r,asChild:d=!1,...o}=e,g=d?i.g7:"button";return(0,t.jsx)(g,{className:(0,l.cn)(c({variant:a,size:r,className:s})),ref:n,...o})});d.displayName="Button"},66070:function(e,n,s){"use strict";s.d(n,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return r},aY:function(){return o},ll:function(){return c}});var t=s(57437),a=s(2265),i=s(94508);let r=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});r.displayName="Card";let l=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,n)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:n,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},32759:function(e,n,s){"use strict";s.d(n,{E:function(){return l}});var t=s(57437),a=s(2265),i=s(60610),r=s(94508);let l=a.forwardRef((e,n)=>{let{className:s,value:a,...l}=e;return(0,t.jsx)(i.fC,{ref:n,className:(0,r.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...l,children:(0,t.jsx)(i.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});l.displayName=i.fC.displayName},19378:function(e,n,s){"use strict";s.d(n,{x:function(){return l}});var t=s(57437),a=s(2265),i=s(43643),r=s(94508);let l=a.forwardRef((e,n)=>{let{className:s,children:a,...l}=e;return(0,t.jsxs)(i.fC,{ref:n,className:(0,r.cn)("relative overflow-hidden",s),...l,children:[(0,t.jsx)(i.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,t.jsx)(c,{}),(0,t.jsx)(i.Ns,{})]})});l.displayName=i.fC.displayName;let c=a.forwardRef((e,n)=>{let{className:s,orientation:a="vertical",...l}=e;return(0,t.jsx)(i.gb,{ref:n,orientation:a,className:(0,r.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,t.jsx)(i.q4,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=i.gb.displayName},42224:function(e,n,s){"use strict";s.d(n,{s:function(){return t}});class t{static isLocalStorageAvailable(){try{if(!window.localStorage)return!1;let e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}static saveRegistration(e){if(!this.isLocalStorageAvailable())throw console.warn("localStorage not available"),Error("Local storage not available");try{let n="reg_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s={id:n,data:e,timestamp:new Date().toISOString(),synced:!1},t=this.getOfflineRegistrations();return t.push(s),localStorage.setItem(this.REGISTRATION_KEY,JSON.stringify(t)),n}catch(e){throw console.error("Error saving registration to offline storage:",e),e}}static getOfflineRegistrations(){if(!this.isLocalStorageAvailable())return[];try{let e=localStorage.getItem(this.REGISTRATION_KEY);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading offline registrations:",e),[]}}static getAllLocalRegistrations(){return this.getOfflineRegistrations().map(e=>({id:e.id,localId:e.id,...e.data,created_at:e.timestamp,synced:e.synced}))}static getUnsyncedRegistrations(){return this.getOfflineRegistrations().filter(e=>!e.synced)}static getPendingRegistrations(){return this.getUnsyncedRegistrations()}static markRegistrationSynced(e,n){if(this.isLocalStorageAvailable())try{let s=this.getOfflineRegistrations(),t=s.find(n=>n.id===e);t&&(t.synced=!0,t.syncedAt=new Date().toISOString(),n&&(t.data.server_id=n),localStorage.setItem(this.REGISTRATION_KEY,JSON.stringify(s)))}catch(e){console.error("Error marking registration as synced:",e)}}static saveScreening(e){if(!this.isLocalStorageAvailable())throw console.warn("localStorage not available"),Error("Local storage not available");try{let n="scr_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s={id:n,data:e,timestamp:new Date().toISOString(),synced:!1},t=this.getOfflineScreenings();return t.push(s),localStorage.setItem(this.SCREENING_KEY,JSON.stringify(t)),n}catch(e){throw console.error("Error saving screening to offline storage:",e),e}}static getOfflineScreenings(){if(!this.isLocalStorageAvailable())return[];try{let e=localStorage.getItem(this.SCREENING_KEY);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading offline screenings:",e),[]}}static getUnsyncedScreenings(){return this.getOfflineScreenings().filter(e=>!e.synced)}static getPendingScreenings(){return this.getUnsyncedScreenings()}static markScreeningSynced(e,n){if(this.isLocalStorageAvailable())try{let s=this.getOfflineScreenings(),t=s.find(n=>n.id===e);t&&(t.synced=!0,t.syncedAt=new Date().toISOString(),n&&(t.data.server_id=n),localStorage.setItem(this.SCREENING_KEY,JSON.stringify(s)))}catch(e){console.error("Error marking screening as synced:",e)}}static setSyncStatus(e){if(this.isLocalStorageAvailable())try{localStorage.setItem(this.SYNC_STATUS_KEY,JSON.stringify(e))}catch(e){console.error("Error setting sync status:",e)}}static getSyncStatus(){if(!this.isLocalStorageAvailable())return{isOnline:"undefined"==typeof navigator||navigator.onLine,pendingCount:0};try{let e=localStorage.getItem(this.SYNC_STATUS_KEY);return e?JSON.parse(e):{isOnline:"undefined"==typeof navigator||navigator.onLine,pendingCount:0}}catch(e){return{isOnline:"undefined"==typeof navigator||navigator.onLine,pendingCount:0}}}static getPendingSyncCount(){return this.getUnsyncedRegistrations().length+this.getUnsyncedScreenings().length}static getPendingCount(){return this.getPendingSyncCount()}static clearSyncedData(){if(this.isLocalStorageAvailable())try{let e=this.getOfflineRegistrations().filter(e=>!e.synced),n=this.getOfflineScreenings().filter(e=>!e.synced);localStorage.setItem(this.REGISTRATION_KEY,JSON.stringify(e)),localStorage.setItem(this.SCREENING_KEY,JSON.stringify(n))}catch(e){console.error("Error clearing synced data:",e)}}static clearAll(){this.clearAllData()}static clearAllData(){if(this.isLocalStorageAvailable())try{localStorage.removeItem(this.REGISTRATION_KEY),localStorage.removeItem(this.SCREENING_KEY),localStorage.removeItem(this.SYNC_STATUS_KEY)}catch(e){console.error("Error clearing all offline data:",e)}}static isOnline(){return"undefined"==typeof navigator||navigator.onLine}static async autoSync(){if(!this.isOnline()){console.log("Offline - skipping auto sync");return}let e=this.getUnsyncedRegistrations(),n=this.getUnsyncedScreenings();if(0===e.length&&0===n.length){console.log("No pending items to sync");return}try{console.log("Syncing ".concat(e.length," registrations and ").concat(n.length," screenings"));let s=await fetch("/api/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrations:e.map(e=>e.data),screenings:n.map(e=>e.data)})}),t=await s.json();t.success?(e.forEach(e=>this.markRegistrationSynced(e.id)),n.forEach(e=>this.markScreeningSynced(e.id)),this.setSyncStatus({lastSync:new Date().toISOString(),isOnline:!0,pendingCount:0}),console.log("Auto-sync completed successfully")):console.error("Auto-sync failed:",t.message)}catch(e){console.error("Auto-sync error:",e)}}}t.REGISTRATION_KEY="swarnabindu_registrations",t.SCREENING_KEY="swarnabindu_screenings",t.SYNC_STATUS_KEY="swarnabindu_sync_status",window.addEventListener("online",()=>{console.log("Back online - attempting auto-sync"),t.setSyncStatus({isOnline:!0,pendingCount:t.getPendingSyncCount()}),t.autoSync()}),window.addEventListener("offline",()=>{console.log("Gone offline - data will be stored locally"),t.setSyncStatus({isOnline:!1,pendingCount:t.getPendingSyncCount()})}),t.isOnline()&&setTimeout(()=>{t.autoSync()},2e3)},94508:function(e,n,s){"use strict";s.d(n,{cn:function(){return i}});var t=s(61994),a=s(53335);function i(){for(var e=arguments.length,n=Array(e),s=0;s<e;s++)n[s]=arguments[s];return(0,a.m6)((0,t.W)(n))}}},function(e){e.O(0,[688,526,660,971,117,744],function(){return e(e.s=28825)}),_N_E=e.O()}]);